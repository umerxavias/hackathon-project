{"version":3,"sources":["random.js","Camera.js","util/MathUtil.js","Controller.js","GameObject.js","Entity.js","InputManager.js","ParticleSystem.js","Animation.js","Player.js","Render.js","ImageEffects.js","SpriteSheet.js","Sprite.js","SpriteSheetManager.js","Game.js","data/SpriteSheets.js","App.js","reportWebVitals.js","index.js"],"names":["getRandom","min","max","Math","random","getRandomInteger","floor","Camera","constructor","game","this","startX","startY","endX","endY","mut","followingObject","followSpeed","followX","followY","minX","minY","maxX","maxY","shakeTick","shakeMagnitude","calculateMultiplier","shake","tick","arguments","length","undefined","magnitude","update","delta","followingCenter","getCenter","cameraCenter","getHeight","getWidth","diffX","diffY","abs","newCenter","speed","x1","y1","x2","y2","y","x","sqrt","getDistance","move","dim","setPositionCenter","updateAspectRatio","maintainHeight","viewport","getViewport","height","newWidth","setPositionCenterAndSize","width","newHeight","scaleSize","scalar","centerX","centerY","cameraMax","setSize","center","transformX","transformY","transformCoordinates","transform","transformRect","w","h","Controller","controlling","player","onGround","inputManager","isKeyDown","crouch","left","right","animation","disableController","facing","running","crouchValue","ledgeHang","slide","animationName","idle","setCrouch","isKeyPressed","jump","isMousePressed","attack","groundSlam","knockback","showInfo","camera","levelWidth","map","rows","i","convertIndexToCoordinates","push","newMap","collisionMap","createCollisionMap","GameObject","velocityX","velocityY","colliding","delete","setVelocity","setLeft","getLeft","setRight","getRight","setTop","top","getTop","setBottom","bottom","getBottom","isNegative","amount","force","tiles","Set","_x","_y","_index","convertCoordinatesToIndex","add","setX","setGroundY","groundY","horizontalCollide","horizontalFlag","position","Array","from","index","block","collidesWith","side","calculateOverlap","flag","setAnimation","other","overrideThis","rect1","rect2","r1","r2","dx","dy","crossWidth","crossHeight","collision","Entity","super","direction","render","drawRect","particleSystem","spawnParticles","InputManager","keyboard","Object","create","keypress","mouse","mousePress","mousePos","mouseMoved","events","addEventListener","eventName","cb","window","start","e","handleKeyEvent","key","handleMouseEvent","button","pageX","pageY","end","forEach","event","removeEventListener","getMousePosition","mouseToButton","str","parseInt","isMouseMove","char","keyCode","toString","toLowerCase","output","isMouseDown","state","ParticleSystem","particles","sizeScale","realAmount","angle","PI","cos","sin","size","ticks","vx","vy","alpha","particle","ctx","globalAlpha","deleting","unshift","splice","Animation","_ref","sprite","frames","after","xOffset","yOffset","timeout","Player","defaultSize","gravityTick","doubleJumped","frictionValue","lastLandY","animations","look_up","run","fall","land","slide_transition","roll","attack1","attack2","attack3","attack4","ground_slam","ground_slam_transition","ledge_climb","ledge_hang","wall_jump","crawl","value","fixSize","Error","oldAnimation","animationTick","setTimeout","done","frame","drawSprite","effects","isArray","wasOnGround","includes","levelHeight","Render","setAlpha","drawLine","strokeWidth","color","strokeStyle","beginPath","moveTo","lineTo","lineWidth","stroke","closePath","fillStyle","fillRect","drawCircle","r","arc","fill","spriteInfo","ssm","getSpriteFromInfoObject","drawScalingSprite","aspectRatio","passedAspectRatio","toFixed","JSON","stringify","drawImage","spriteSheet","image","img","sx","sy","sw","sh","round","drawImageWithRotation","_w","_h","rotateDegrees","context","angleInRadians","translate","rotate","drawText","text","fontSize","font","fillText","drawScalingText","ImageEffects","canvas","document","createElement","getContext","async","firstImage","images","Map","clonedSprites","spriteName","sprites","clonedSprite","Sprite","has","get","set","topLevel","SpriteSheet","applyEffectsToImage","type","keys","newImage","newSpriteSheet","currentImage","effect","applyEffectToImage","Promise","resolve","reject","effectName","name","clearRect","flipHorizontally","teamColor","payload","outputImage","Image","dataURL","toDataURL","src","onload","loaded","join","globalCompositeOperation","scale","setTransform","imgPath","info","spriteSheetManager","isTopLevel","SpriteSheetManager","effectsCache","creating","process","console","log","incrementLoaded","border","imageWidth","imageHeight","prefix","split","newImageSRC","childSprite","indirect","getSprite","getEffects","imageEffects","applyEffectsToSpriteSheet","spriteSheets","assetsLoaded","assetsTotal","hasLoaded","onLoaded","addSpriteSheet","ss","getSpriteSheet","spriteSheetName","path","Game","controller","entities","level","flat","spawnTick","fpsTick","fps","spawnEntity","id","v4","entity","renderGame","entityUUID","collisionFlag","tileKeys","tile","updateGame","deleteUUIDs","SpriteSheets","player_idle","player_run","player_jump","player_land","player_slide","player_roll","player_combat_combo_01_attack_01","player_combat_combo_01_attack_02","player_combat_combo_01_attack_03","player_combat_combo_01_attack_04","player_combat_ground_slam","player_look_up","player_knockback","player_ledge_climb","player_ledge_hang","player_wall_jump","player_wall_slide","player_crouch","player_crawl","player_front_flip","App","canvasRef","useRef","menu","setMenu","useState","gameRef","useEffect","data","current","last","performance","now","innerWidth","innerHeight","style","active","cancelAnimationFrame","requestAnimationFrame","_jsxs","className","children","_jsx","onClick","ref","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","React","StrictMode","getElementById"],"mappings":"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AAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAC3C,CAAC,EAAG,EAAG,E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","file":"static/js/main.24eef3bd.chunk.js","sourcesContent":["export function getRandom(min, max) {\r\n  return Math.random() * (max - min) + min;\r\n}\r\n\r\nexport function getRandomInteger(min, max) {\r\n  return Math.floor(getRandom(min, max));\r\n}\r\n","import Game from \"./Game\";\r\nimport { getRandom } from \"./random\";\r\nimport { getDistance } from \"./util/MathUtil\";\r\n\r\nexport default class Camera {\r\n  /**\r\n   *\r\n   * @param {Game} game\r\n   */\r\n  constructor(game) {\r\n    this.game = game;\r\n    this.startX = 0;\r\n    this.startY = 0;\r\n    this.endX = 16;\r\n    this.endY = 11;\r\n\r\n    this.mut = [1, 1];\r\n    this.followingObject = null;\r\n    this.followSpeed = 2;\r\n    this.followX = true;\r\n    this.followY = true;\r\n\r\n    this.minX = null;\r\n    this.minY = null;\r\n\r\n    this.maxX = null;\r\n    this.maxY = null;\r\n\r\n    this.shakeTick = 0;\r\n    this.shakeMagnitude = 1;\r\n\r\n    this.calculateMultiplier();\r\n  }\r\n\r\n  shake(tick = 0.3, magnitude = 1) {\r\n    this.shakeTick = tick;\r\n    this.shakeMagnitude = magnitude;\r\n  }\r\n\r\n  update(delta) {\r\n    if (this.followingObject) {\r\n      var followingCenter = this.followingObject.getCenter();\r\n      var cameraCenter = this.getCenter();\r\n\r\n      if (typeof this.maxY === \"number\") {\r\n        followingCenter[1] = Math.min(\r\n          this.maxY - this.getHeight() / 2,\r\n          followingCenter[1]\r\n        );\r\n      }\r\n\r\n      if (typeof this.minX === \"number\") {\r\n        followingCenter[0] = Math.max(\r\n          this.minX + this.getWidth() / 2,\r\n          followingCenter[0]\r\n        );\r\n      }\r\n\r\n      var diffX = followingCenter[0] - cameraCenter[0];\r\n      var diffY = followingCenter[1] - cameraCenter[1];\r\n\r\n      if (Math.abs(diffX) > 0.01 || Math.abs(diffY) > 0.01) {\r\n        var newCenter = [cameraCenter[0], cameraCenter[1]];\r\n        var speed =\r\n          getDistance(\r\n            followingCenter[0],\r\n            followingCenter[1],\r\n            cameraCenter[0],\r\n            cameraCenter[1]\r\n          ) *\r\n          delta *\r\n          this.followSpeed;\r\n\r\n        function move(dim) {\r\n          if (newCenter[dim] < followingCenter[dim]) {\r\n            if (newCenter[dim] + speed < followingCenter[dim]) {\r\n              newCenter[dim] += speed;\r\n            } else {\r\n              newCenter[dim] = followingCenter[dim];\r\n            }\r\n          } else if (newCenter[dim] > followingCenter[dim]) {\r\n            if (newCenter[dim] - speed > followingCenter[dim]) {\r\n              newCenter[dim] -= speed;\r\n            } else {\r\n              newCenter[dim] = followingCenter[dim];\r\n            }\r\n          }\r\n        }\r\n\r\n        if (Math.abs(diffX) > 0.1 && this.followX) {\r\n          move(0);\r\n        }\r\n\r\n        if (Math.abs(diffY) > 0.1 && this.followY) {\r\n          move(1);\r\n        }\r\n\r\n        if (this.shakeTick > 0) {\r\n          this.shakeTick -= delta;\r\n\r\n          newCenter[0] += (getRandom(-1, 1) / 100) * this.shakeMagnitude;\r\n          newCenter[1] += (getRandom(-1, 1) / 100) * this.shakeMagnitude;\r\n        }\r\n\r\n        this.setPositionCenter(newCenter[0], newCenter[1]);\r\n      }\r\n    }\r\n  }\r\n\r\n  updateAspectRatio(maintainHeight = true) {\r\n    var viewport = this.game.getViewport();\r\n\r\n    if (maintainHeight) {\r\n      var height = this.getHeight();\r\n\r\n      var newWidth = height * (viewport[0] / viewport[1]);\r\n\r\n      this.setPositionCenterAndSize(...this.getCenter(), newWidth, height);\r\n    } else {\r\n      var width = this.getWidth();\r\n      var newHeight = width * (viewport[1] / viewport[0]);\r\n\r\n      this.setPositionCenterAndSize(...this.getCenter(), width, newHeight);\r\n    }\r\n  }\r\n\r\n  scaleSize(scalar = 1) {\r\n    this.setPositionCenterAndSize(\r\n      ...this.getCenter(),\r\n      this.getWidth() * scalar,\r\n      this.getHeight() * scalar\r\n    );\r\n  }\r\n\r\n  setPositionCenter(centerX, centerY) {\r\n    this.setPositionCenterAndSize(\r\n      centerX,\r\n      centerY,\r\n      this.endX - this.startX,\r\n      this.endY - this.startY\r\n    );\r\n  }\r\n\r\n  setPositionCenterAndSize(centerX, centerY, width, height) {\r\n    var cameraMax = [width, height];\r\n\r\n    this.startX = centerX - cameraMax[0] / 2;\r\n    this.startY = centerY - cameraMax[1] / 2;\r\n    this.endX = centerX + cameraMax[0] / 2;\r\n    this.endY = centerY + cameraMax[1] / 2;\r\n\r\n    this.calculateMultiplier();\r\n  }\r\n\r\n  setSize(width, height) {\r\n    var center = this.getCenter();\r\n\r\n    this.setPositionCenterAndSize(center[0], center[1], width, height);\r\n  }\r\n\r\n  getCenter() {\r\n    return [\r\n      this.startX + this.getWidth() / 2,\r\n      this.startY + this.getHeight() / 2,\r\n    ];\r\n  }\r\n\r\n  getWidth() {\r\n    return this.endX - this.startX;\r\n  }\r\n\r\n  getHeight() {\r\n    return this.endY - this.startY;\r\n  }\r\n\r\n  calculateMultiplier() {\r\n    var viewport = this.game.getViewport();\r\n    this.mut = [viewport[0] / this.getWidth(), viewport[1] / this.getHeight()];\r\n  }\r\n\r\n  transformX(x) {\r\n    return x * this.mut[0];\r\n  }\r\n\r\n  transformY(y) {\r\n    return y * this.mut[1];\r\n  }\r\n\r\n  transformCoordinates(x, y) {\r\n    var transform = [x - this.startX, y - this.startY];\r\n    transform[0] *= this.mut[0];\r\n    transform[1] *= this.mut[1];\r\n    return transform;\r\n  }\r\n\r\n  transformRect(x, y, w, h) {\r\n    return [\r\n      ...this.transformCoordinates(x, y),\r\n      this.transformX(w),\r\n      this.transformY(h),\r\n    ];\r\n  }\r\n}\r\n","export function getDistance(x1, y1, x2, y2) {\r\n  let y = x2 - x1;\r\n  let x = y2 - y1;\r\n\r\n  return Math.sqrt(x * x + y * y);\r\n}\r\n\r\nexport function degreesToRadians(degrees) {\r\n  var pi = Math.PI;\r\n  return degrees * (pi / 180);\r\n}\r\n\r\nexport function radiansToDegree(radians) {\r\n  return radians * (180 / Math.PI);\r\n}\r\n","import Game from \"./Game\";\r\n\r\nexport default class Controller {\r\n  constructor(game) {\r\n    /**\r\n     * @type {Game}\r\n     */\r\n    this.game = game;\r\n\r\n    this.controlling = this.game.player;\r\n  }\r\n\r\n  update(delta) {\r\n    var speed = (this.controlling.onGround ? 6 : 5.5) * delta;\r\n\r\n    if (this.game.inputManager.isKeyDown(\"shift\")) {\r\n      speed /= 5;\r\n    }\r\n\r\n    if (this.controlling.crouch) {\r\n      speed /= 5;\r\n    }\r\n\r\n    var left =\r\n      this.game.inputManager.isKeyDown(\"a\") ||\r\n      this.game.inputManager.isKeyDown(\"ArrowLeft\");\r\n\r\n    var right =\r\n      this.game.inputManager.isKeyDown(\"d\") ||\r\n      this.game.inputManager.isKeyDown(\"ArrowRight\");\r\n\r\n    var move = left ^ right && !this.controlling.animation.disableController;\r\n\r\n    if (move) {\r\n      if (left) {\r\n        this.controlling.x -= speed;\r\n        this.controlling.facing = 0;\r\n      }\r\n\r\n      if (right) {\r\n        this.controlling.x += speed;\r\n        this.controlling.facing = 1;\r\n      }\r\n\r\n      if (!this.controlling.running) {\r\n        this.controlling.running = true;\r\n      }\r\n    } else {\r\n      if (this.controlling.running) {\r\n        this.controlling.running = false;\r\n      }\r\n    }\r\n\r\n    var crouchValue = false;\r\n\r\n    if (\r\n      this.game.inputManager.isKeyDown(\"s\") ||\r\n      this.game.inputManager.isKeyDown(\"ArrowDown\")\r\n    ) {\r\n      if (this.controlling.ledgeHang) {\r\n        this.controlling.y += delta;\r\n      } else {\r\n        if (this.controlling.onGround) {\r\n          if (move) {\r\n            if (this.controlling.crouch) {\r\n              crouchValue = true;\r\n            } else {\r\n              this.controlling.slide();\r\n            }\r\n          } else {\r\n            crouchValue =\r\n              this.controlling.animationName === \"crouch\" ||\r\n              this.controlling.animationName === \"crawl\" ||\r\n              this.controlling.animation.idle;\r\n          }\r\n        } else {\r\n        }\r\n      }\r\n    }\r\n\r\n    this.controlling.setCrouch(crouchValue);\r\n\r\n    if (\r\n      this.game.inputManager.isKeyPressed(\"w\") ||\r\n      this.game.inputManager.isKeyPressed(\" \") ||\r\n      this.game.inputManager.isKeyPressed(\"ArrowUp\")\r\n    ) {\r\n      if (!this.controlling.animation.disableController) {\r\n        this.controlling.jump();\r\n      }\r\n    }\r\n\r\n    if (!this.controlling.animation.disableController) {\r\n      if (this.game.inputManager.isMousePressed(\"0\")) {\r\n        if (this.controlling.onGround) {\r\n          this.controlling.attack();\r\n        } else {\r\n          this.controlling.groundSlam();\r\n        }\r\n      }\r\n\r\n      if (this.game.inputManager.isKeyPressed(\"f\")) {\r\n        this.controlling.knockback();\r\n      }\r\n\r\n      if (this.game.inputManager.isKeyPressed(\"g\")) {\r\n        this.game.showInfo = !this.game.showInfo;\r\n      }\r\n    }\r\n\r\n    if (this.game.inputManager.isKeyPressed(\"-\")) {\r\n      this.game.camera.scaleSize(1.1);\r\n    }\r\n    if (this.game.inputManager.isKeyPressed(\"=\")) {\r\n      this.game.camera.scaleSize(0.9);\r\n    }\r\n\r\n    if (this.controlling.x > this.game.levelWidth / 5) {\r\n      var map = this.game.map;\r\n      var rows = [];\r\n\r\n      for (var i = 0; i < map.length; i++) {\r\n        var [x, y] = this.game.convertIndexToCoordinates(i);\r\n        var row = rows[y] || (rows[y] = []);\r\n\r\n        row.push(map[i]);\r\n      }\r\n\r\n      var newMap = [];\r\n\r\n      for (var i = 0; i < rows.length; i++) {\r\n        newMap.push(...rows[i], ...rows[i]);\r\n      }\r\n\r\n      this.game.map = newMap;\r\n      this.game.levelWidth *= 2;\r\n\r\n      this.game.collisionMap = this.game.createCollisionMap();\r\n    }\r\n  }\r\n}\r\n","import Game from \"./Game\";\r\n\r\nexport default class GameObject {\r\n  constructor(game) {\r\n    /**\r\n     * @type {Game}\r\n     */\r\n    this.game = game;\r\n    this.x = 0;\r\n    this.y = 0;\r\n    this.w = 0;\r\n    this.h = 0;\r\n\r\n    this.velocityX = 0;\r\n    this.velocityY = 0;\r\n\r\n    this.colliding = false;\r\n    this.delete = false;\r\n  }\r\n\r\n  setVelocity(velocityX, velocityY) {\r\n    this.velocityX = velocityX;\r\n    this.velocityY = velocityY;\r\n  }\r\n\r\n  setLeft(left) {\r\n    this.x = left;\r\n  }\r\n\r\n  getLeft() {\r\n    return this.x;\r\n  }\r\n\r\n  setRight(right) {\r\n    this.x = right - this.w;\r\n  }\r\n\r\n  getRight() {\r\n    return this.x + this.w;\r\n  }\r\n\r\n  setTop(top) {\r\n    this.y = top;\r\n  }\r\n\r\n  getTop() {\r\n    return this.y;\r\n  }\r\n\r\n  setBottom(bottom) {\r\n    this.y = bottom - this.h;\r\n  }\r\n\r\n  getBottom() {\r\n    return this.y + this.h;\r\n  }\r\n\r\n  getCenter() {\r\n    return [this.x + this.w / 2, this.y + this.h / 2];\r\n  }\r\n\r\n  update(delta) {\r\n    // compute velocity\r\n    if (this.velocityX) {\r\n      var isNegative = this.velocityX < 0;\r\n      var abs = Math.abs(this.velocityX);\r\n\r\n      var amount = Math.max(abs * 4 * delta, delta / 2);\r\n      if (amount > abs) {\r\n        amount = abs;\r\n      }\r\n\r\n      abs -= amount;\r\n      if (abs < 0) {\r\n        abs = 0;\r\n      }\r\n\r\n      this.velocityX = isNegative ? -abs : abs;\r\n      var force = isNegative ? -amount : amount;\r\n\r\n      this.x += force;\r\n    }\r\n\r\n    if (this.velocityY) {\r\n      var isNegative = this.velocityY < 0;\r\n      var abs = Math.abs(this.velocityY);\r\n\r\n      var amount = Math.max(abs * 4 * delta, delta / 2);\r\n      if (amount > abs) {\r\n        amount = abs;\r\n      }\r\n\r\n      abs -= amount;\r\n      if (abs < 0) {\r\n        abs = 0;\r\n      }\r\n\r\n      this.velocityY = isNegative ? -abs : abs;\r\n      var force = isNegative ? -amount : amount;\r\n\r\n      this.y += force;\r\n    }\r\n\r\n    this.tiles = {};\r\n\r\n    this.onGround = false;\r\n    this.colliding = false;\r\n\r\n    var colliding = new Set();\r\n\r\n    for (\r\n      var x = Math.floor(this.x) - 1;\r\n      x <= Math.floor(this.x + this.w) + 1;\r\n      x += 0.4\r\n    ) {\r\n      for (\r\n        var y = Math.floor(this.y) - 1;\r\n        y <= Math.floor(this.y + this.h) + 1;\r\n        y += 0.4\r\n      ) {\r\n        var _x = Math.floor(x);\r\n        var _y = Math.floor(y);\r\n\r\n        var _index = this.game.convertCoordinatesToIndex(_x, _y);\r\n\r\n        if (this.game.collisionMap[_index]) {\r\n          colliding.add(_index);\r\n        }\r\n      }\r\n    }\r\n\r\n    var setX = null;\r\n    var setGroundY = 0;\r\n    var groundY = 0;\r\n    var horizontalCollide = null;\r\n    var horizontalFlag = false;\r\n\r\n    for (var position of Array.from(colliding)) {\r\n      var index = position;\r\n      var [x, y] = this.game.convertIndexToCoordinates(index);\r\n\r\n      var block = {\r\n        x,\r\n        y,\r\n        w: 1,\r\n        h: 1,\r\n      };\r\n\r\n      if (this.collidesWith(block)) {\r\n        var side = this.calculateOverlap(block);\r\n        if (side === \"top\") {\r\n          if (\r\n            !this.crouch &&\r\n            this.calculateOverlap(block, {\r\n              x: this.x,\r\n              y: this.getBottom() - 0.1,\r\n              w: this.w,\r\n              h: 0.1,\r\n            }) !== \"top\"\r\n          ) {\r\n            side = this.x < block.x ? \"left\" : \"right\";\r\n          }\r\n        }\r\n        var flag = {\r\n          left: 1,\r\n          right: 2,\r\n          top: 4,\r\n          bottom: 8,\r\n        }[side];\r\n\r\n        if (this.game.collisionMap[index] & flag) {\r\n          this.colliding = true;\r\n\r\n          if (side === \"top\") {\r\n            this.onGround = true;\r\n            groundY = y;\r\n            if (this.getBottom() > y) {\r\n              this.setBottom(y + 0.01);\r\n            }\r\n          } else if (side === \"bottom\") {\r\n            if (this.getTop() < y + 1) {\r\n              this.setTop(y + 1);\r\n            }\r\n          } else if (side === \"left\") {\r\n            setX = x - this.w;\r\n            setGroundY = y;\r\n            horizontalCollide = block;\r\n            horizontalFlag = this.facing === 1;\r\n          } else if (side === \"right\") {\r\n            setX = x + block.w;\r\n            setGroundY = y;\r\n            horizontalCollide = block;\r\n            horizontalFlag = this.facing === 0;\r\n          }\r\n\r\n          this.tiles[index] = flag;\r\n        }\r\n\r\n        // console.log(this, block);\r\n      }\r\n    }\r\n\r\n    if (typeof setX === \"number\" && groundY !== setGroundY) {\r\n      this.x = setX;\r\n\r\n      if (\r\n        !this.onGround &&\r\n        this.animationName !== \"crawl\" &&\r\n        this.animationName !== \"roll\" &&\r\n        horizontalFlag &&\r\n        this.game.collisionMap[\r\n          this.game.convertCoordinatesToIndex(\r\n            horizontalCollide.x,\r\n            horizontalCollide.y - 1\r\n          )\r\n        ] &&\r\n        (this.y - Math.floor(this.y) < 0.3 ||\r\n          this.game.collisionMap[\r\n            this.game.convertCoordinatesToIndex(\r\n              horizontalCollide.x,\r\n              horizontalCollide.y + 1\r\n            )\r\n          ])\r\n      ) {\r\n        this.ledgeHang = true;\r\n\r\n        if (\r\n          this.animationName !== \"ledge_hang\" &&\r\n          this.animationName !== \"wall_jump\"\r\n        ) {\r\n          this.setAnimation(\"ledge_hang\");\r\n        }\r\n      }\r\n    } else {\r\n      if (this.ledgeHang) {\r\n        this.ledgeHang = false;\r\n        this.setAnimation(\"fall\");\r\n      }\r\n    }\r\n  }\r\n\r\n  collidesWith(other, overrideThis) {\r\n    var rect1 = overrideThis || this;\r\n    var rect2 = other;\r\n\r\n    return (\r\n      rect1.x < rect2.x + rect2.w &&\r\n      rect1.x + rect1.w > rect2.x &&\r\n      rect1.y < rect2.y + rect2.h &&\r\n      rect1.h + rect1.y > rect2.y\r\n    );\r\n  }\r\n\r\n  calculateOverlap(other, overrideThis) {\r\n    var r1 = overrideThis || this;\r\n    var r2 = other;\r\n\r\n    var dx = r1.x + r1.w / 2 - (r2.x + r2.w / 2);\r\n    var dy = r1.y + r1.h / 2 - (r2.y + r2.h / 2);\r\n    var width = (r1.w + r2.w) / 2;\r\n    var height = (r1.h + r2.h) / 2;\r\n    var crossWidth = width * dy;\r\n    var crossHeight = height * dx;\r\n    var collision = \"none\";\r\n    //\r\n    if (Math.abs(dx) <= width && Math.abs(dy) <= height) {\r\n      if (crossWidth > crossHeight) {\r\n        collision = crossWidth > -crossHeight ? \"bottom\" : \"left\";\r\n      } else {\r\n        collision = crossWidth > -crossHeight ? \"right\" : \"top\";\r\n      }\r\n    }\r\n    return collision;\r\n  }\r\n}\r\n","import GameObject from \"./GameObject\";\r\n\r\nexport default class Entity extends GameObject {\r\n  constructor(game) {\r\n    super(game);\r\n\r\n    this.w = 0.1;\r\n    this.h = 0.1;\r\n\r\n    this.direction = -1;\r\n  }\r\n\r\n  render() {\r\n    this.game.render.drawRect(this.x, this.y, this.w, this.h, \"#ff2222\");\r\n  }\r\n\r\n  update(delta) {\r\n    this.x += delta * this.direction * 3;\r\n\r\n    super.update();\r\n\r\n    if (this.collidesWith(this.game.player)) {\r\n      if (this.game.player.animationName === \"attack1\") {\r\n        this.direction = this.game.player.facing === 0 ? -1 : 1;\r\n\r\n        this.game.particleSystem.spawnParticles(this.x, this.y, 6, 0.5);\r\n\r\n        this.game.camera.shake();\r\n      } else if (this.game.player.animationName === \"ground_slam\") {\r\n        this.colliding = true;\r\n        this.game.camera.shake();\r\n      } else {\r\n        this.game.player.facing = this.direction < 0 ? 1 : 0;\r\n\r\n        this.game.player.knockback();\r\n        this.colliding = true;\r\n      }\r\n    }\r\n\r\n    if (this.colliding) {\r\n      this.delete = true;\r\n\r\n      this.game.particleSystem.spawnParticles(this.x, this.y, 5, 0.3);\r\n    }\r\n  }\r\n}\r\n","export default class InputManager {\r\n  constructor() {\r\n    this.keyboard = Object.create(null);\r\n    this.keypress = Object.create(null);\r\n    this.mouse = Object.create(null);\r\n    this.mousePress = Object.create(null);\r\n\r\n    this.mousePos = [];\r\n    this.mouseMoved = true;\r\n    this.events = [];\r\n  }\r\n\r\n  addEventListener(eventName, cb) {\r\n    window.addEventListener(eventName, cb);\r\n    this.events.push([eventName, cb]);\r\n  }\r\n\r\n  start() {\r\n    this.addEventListener(\"keydown\", (e) => {\r\n      this.handleKeyEvent(e.key, true);\r\n    });\r\n\r\n    this.addEventListener(\"keyup\", (e) => {\r\n      this.handleKeyEvent(e.key, false);\r\n    });\r\n\r\n    this.addEventListener(\"mousedown\", (e) => {\r\n      this.handleMouseEvent(e.button, true);\r\n    });\r\n\r\n    this.addEventListener(\"mouseup\", (e) => {\r\n      this.handleMouseEvent(e.button, false);\r\n    });\r\n\r\n    this.addEventListener(\"mousemove\", (e) => {\r\n      this.mousePos = [e.pageX, e.pageY];\r\n      this.mouseMoved = true;\r\n    });\r\n  }\r\n\r\n  end() {\r\n    this.events.forEach((event) => {\r\n      window.removeEventListener(event[0], event[1]);\r\n    });\r\n\r\n    this.events = [];\r\n  }\r\n\r\n  getMousePosition() {\r\n    return this.mousePos;\r\n  }\r\n\r\n  mouseToButton(str) {\r\n    if (str === \"left\") {\r\n      return 0;\r\n    }\r\n    if (str === \"right\") {\r\n      return 2;\r\n    }\r\n\r\n    return parseInt(str);\r\n  }\r\n\r\n  isMouseMove() {\r\n    if (this.mouseMoved) {\r\n      this.mouseMoved = false;\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  isKeyDown(char) {\r\n    var keyCode = char.toString().toLowerCase();\r\n\r\n    return !!this.keyboard[keyCode];\r\n  }\r\n\r\n  isKeyPressed(char) {\r\n    var keyCode = char.toString().toLowerCase();\r\n\r\n    var output = this.keypress[keyCode];\r\n    if (output) {\r\n      this.keypress[keyCode] = false;\r\n    }\r\n\r\n    return output;\r\n  }\r\n\r\n  isMouseDown(str) {\r\n    return this.mouse[this.mouseToButton(str)];\r\n  }\r\n\r\n  isMousePressed(str) {\r\n    var button = this.mouseToButton(str);\r\n\r\n    var output = this.mousePress[button];\r\n    if (output) {\r\n      this.mousePress[button] = false;\r\n    }\r\n\r\n    return output;\r\n  }\r\n\r\n  handleKeyEvent(char, state) {\r\n    var keyCode = char.toString().toLowerCase();\r\n\r\n    if (state && this.keyboard[keyCode]) {\r\n      return;\r\n    }\r\n    this.keyboard[keyCode] = state;\r\n    this.keypress[keyCode] = state;\r\n  }\r\n\r\n  handleMouseEvent(button, state) {\r\n    this.mouse[button] = state;\r\n    this.mousePress[button] = state;\r\n  }\r\n}\r\n","import Game from \"./Game\";\r\nimport { getRandom, getRandomInteger } from \"./random\";\r\n\r\nexport default class ParticleSystem {\r\n  constructor(game) {\r\n    /**\r\n     * @type {Game}\r\n     */\r\n    this.game = game;\r\n\r\n    /**\r\n     * @type {Array.<{ x: number, y: number, size: number, ticks: number, vx: number, vy: number, alpha: number }>}\r\n     */\r\n    this.particles = [];\r\n  }\r\n\r\n  spawnParticles(x, y, amount = 5, sizeScale = 1) {\r\n    var realAmount =\r\n      amount === 1 ? amount : getRandomInteger(amount * 0.9, amount * 1.1);\r\n\r\n    for (var i = 0; i < realAmount; i++) {\r\n      var angle = getRandom(0, Math.PI * 2);\r\n      var speed = getRandom(0.1, 6) / 100;\r\n\r\n      var dx = (Math.cos(angle) * getRandom(3, 5)) / 100;\r\n      var dy = (Math.sin(angle) * getRandom(3, 5)) / 100;\r\n\r\n      this.particles.push({\r\n        x: x + dx,\r\n        y: y + dy,\r\n        size: getRandom(3, 6 * sizeScale) / 100,\r\n        ticks: getRandom(0, 1),\r\n        vx: Math.cos(angle) * speed,\r\n        vy: Math.sin(angle) * speed,\r\n        alpha: getRandom(0, 0.1),\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    for (var particle of this.particles) {\r\n      this.game.ctx.globalAlpha = Math.min(1, Math.max(0, particle.alpha));\r\n\r\n      this.game.render.drawRect(\r\n        particle.x,\r\n        particle.y,\r\n        Math.max(0, particle.size),\r\n        Math.max(0, particle.size),\r\n        \"#fff\"\r\n      );\r\n    }\r\n\r\n    this.game.ctx.globalAlpha = 1;\r\n  }\r\n\r\n  update(delta) {\r\n    var deleting = [];\r\n\r\n    for (var i = 0; i < this.particles.length; i++) {\r\n      var particle = this.particles[i];\r\n\r\n      particle.x += delta * particle.vx;\r\n      particle.y += delta * particle.vy;\r\n\r\n      particle.ticks += delta;\r\n\r\n      if (particle.ticks > 2) {\r\n        particle.size -= delta / 200;\r\n        particle.alpha -= delta / 2;\r\n\r\n        if (particle.size < 0.0001 || particle.alpha < 0.0001) {\r\n          deleting.unshift(i);\r\n        }\r\n      } else if (particle.alpha < 1) {\r\n        particle.alpha += delta * 3;\r\n      }\r\n    }\r\n\r\n    for (var i = 0; i < deleting.length; i++) {\r\n      this.particles.splice(deleting[i], 1);\r\n    }\r\n  }\r\n}\r\n","export default class Animation {\r\n  constructor({\r\n    sprite,\r\n    frames,\r\n    speed,\r\n    after,\r\n    xOffset,\r\n    yOffset,\r\n    disableController,\r\n    idle,\r\n    size,\r\n    timeout,\r\n  }) {\r\n    this.sprite = sprite;\r\n    this.frames = frames;\r\n    this.speed = speed;\r\n\r\n    this.after = after;\r\n\r\n    this.disableController = !!disableController;\r\n\r\n    this.xOffset = xOffset || 0;\r\n    this.yOffset = yOffset || 0;\r\n\r\n    this.idle = !!idle;\r\n    this.size = size;\r\n\r\n    this.timeout = timeout;\r\n  }\r\n}\r\n","import Animation from \"./Animation\";\r\nimport Game from \"./Game\";\r\nimport GameObject from \"./GameObject\";\r\nimport { getDistance } from \"./math\";\r\nimport { getRandomInteger } from \"./random\";\r\nimport { radiansToDegree } from \"./util/MathUtil\";\r\n\r\nexport default class Player extends GameObject {\r\n  constructor(game) {\r\n    super(game);\r\n    this.x = 5;\r\n    this.y = 5;\r\n\r\n    this.w = 0.55;\r\n    this.h = 0.95;\r\n    this.defaultSize = [this.w, this.h];\r\n\r\n    this.onGround = false;\r\n    this.running = false;\r\n    this.gravityTick = 0;\r\n\r\n    this.ledgeHang = false;\r\n\r\n    this.doubleJumped = false;\r\n    this.frictionValue = 0;\r\n    /**\r\n     * - `0` = Left\r\n     * - `1` = Right\r\n     */\r\n    this.facing = 0;\r\n\r\n    /**\r\n     * @type {Game}\r\n     */\r\n    this.game = game;\r\n\r\n    this.tiles = {};\r\n\r\n    this.lastLandY = 0;\r\n\r\n    this.animations = {\r\n      idle: new Animation({\r\n        sprite: \"player_idle\",\r\n        frames: [0, 1, 2, 3, 4, 5, 6],\r\n        speed: 140,\r\n        after: \"idle\",\r\n        idle: true,\r\n      }),\r\n      look_up: new Animation({\r\n        sprite: \"player_look_up\",\r\n        frames: [0, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0],\r\n        speed: 200,\r\n        after: \"idle\",\r\n        idle: true,\r\n      }),\r\n      run: new Animation({\r\n        sprite: \"player_run\",\r\n        frames: [0, 1, 2, 3, 4, 5, 7],\r\n        speed: 120,\r\n      }),\r\n      jump: new Animation({\r\n        sprite: \"player_jump\",\r\n        frames: [0],\r\n        speed: 110,\r\n        after: \"fall\",\r\n      }),\r\n      fall: new Animation({\r\n        sprite: \"player_jump\",\r\n        frames: [1, 2],\r\n        speed: 250,\r\n        after: \"fall\",\r\n      }),\r\n      land: new Animation({\r\n        sprite: \"player_land\",\r\n        frames: [0, 1],\r\n        speed: 100,\r\n        after: \"idle\",\r\n        idle: true,\r\n      }),\r\n      slide: new Animation({\r\n        sprite: \"player_slide\",\r\n        frames: [0, 1, 2],\r\n        speed: 90,\r\n        after: \"slide_transition\",\r\n        disableController: false,\r\n        size: [1, 0.6],\r\n        yOffset: -0.4,\r\n        xOffset: [0.3, 0.2],\r\n        timeout: false\r\n      }),\r\n      slide_transition: new Animation({\r\n        sprite: \"player_slide\",\r\n        frames: [3],\r\n        speed: 100,\r\n        after: \"idle\",\r\n        idle: true,\r\n      }),\r\n      roll: new Animation({\r\n        sprite: \"player_front_flip\",\r\n        frames: [5, 6, 7, 8, 9, 10, 11, 12],\r\n        speed: 60,\r\n        after: \"fall\",\r\n        size: [0.55, 0.6],\r\n        yOffset: -0.15,\r\n      }),\r\n      attack1: new Animation({\r\n        sprite: \"player_combat_combo_01_attack_01\",\r\n        frames: [0, 1, 2, 3, 4, 5],\r\n        speed: 100,\r\n        after: \"idle\",\r\n        disableController: true,\r\n      }),\r\n      attack2: new Animation({\r\n        sprite: \"player_combat_combo_01_attack_02\",\r\n        frames: [0, 1, 2, 3, 4],\r\n        speed: 100,\r\n        after: \"idle\",\r\n        disableController: true,\r\n      }),\r\n      attack3: new Animation({\r\n        sprite: \"player_combat_combo_01_attack_03\",\r\n        frames: [0, 1, 2, 3],\r\n        speed: 100,\r\n        after: \"idle\",\r\n        disableController: true,\r\n      }),\r\n      attack4: new Animation({\r\n        sprite: \"player_combat_combo_01_attack_04\",\r\n        frames: [0, 1, 2, 3, 4, 5, 6, 7, 8],\r\n        speed: 100,\r\n        after: \"idle\",\r\n        disableController: true,\r\n      }),\r\n      ground_slam: new Animation({\r\n        sprite: \"player_combat_ground_slam\",\r\n        frames: [0, 1, 2, 3, 4, 5, 6],\r\n        speed: 100,\r\n        after: \"ground_slam_transition\",\r\n        disableController: true,\r\n      }),\r\n      ground_slam_transition: new Animation({\r\n        sprite: \"player_combat_ground_slam\",\r\n        frames: [7, 8, 9],\r\n        speed: 100,\r\n        after: \"idle\",\r\n        idle: true,\r\n      }),\r\n      knockback: new Animation({\r\n        sprite: \"player_knockback\",\r\n        frames: [0, 1, 2, 4, 4, 4, 4, 4, 4, 4, 5],\r\n        speed: 100,\r\n        after: \"idle\",\r\n        disableController: true,\r\n      }),\r\n      ledge_climb: new Animation({\r\n        sprite: \"player_ledge_climb\",\r\n        frames: [0, 1, 2, 3, 4, 5, 6, 7],\r\n        speed: 100,\r\n        after: \"ledge_climb\",\r\n        xOffset: [0.3, -0.3],\r\n        yOffset: 0.9,\r\n      }),\r\n      ledge_hang: new Animation({\r\n        sprite: \"player_ledge_hang\",\r\n        frames: [0, 1, 2, 3, 4, 5],\r\n        speed: 100,\r\n        after: \"ledge_hang\",\r\n        xOffset: [-0.1, 0.11],\r\n      }),\r\n      wall_jump: new Animation({\r\n        sprite: \"player_wall_jump\",\r\n        frames: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],\r\n        speed: 100,\r\n        after: \"fall\",\r\n      }),\r\n      crouch: new Animation({\r\n        sprite: \"player_crouch\",\r\n        frames: [0, 1, 2, 3, 4, 5],\r\n        speed: 100,\r\n        after: \"crouch\",\r\n        size: [0.55, 0.6],\r\n        yOffset: -0.4,\r\n      }),\r\n      crawl: new Animation({\r\n        sprite: \"player_crawl\",\r\n        frames: [0, 1, 2, 3, 4, 5, 6, 7],\r\n        speed: 120,\r\n        after: \"crawl\",\r\n        size: [0.55, 0.6],\r\n        yOffset: -0.4,\r\n      }),\r\n    };\r\n\r\n    /**\r\n     * @type {Animation}\r\n     */\r\n    this.animation = null;\r\n    this.animationName = \"\";\r\n\r\n    this.setAnimation(\"idle\");\r\n    this.crouch = false;\r\n  }\r\n\r\n  setCrouch(value) {\r\n    if (!this.crouch && value) {\r\n      this.setAnimation(\"crouch\");\r\n      this.crouch = true;\r\n    } else if (this.crouch && !value) {\r\n      this.crouch = false;\r\n\r\n      this.setAnimation(\"idle\");\r\n    }\r\n  }\r\n\r\n  setAnimation(animationName, fixSize = true) {\r\n    if (!this.animations[animationName]) {\r\n      throw new Error(\"Invalid animation: \" + animationName);\r\n    }\r\n\r\n    if (animationName !== \"crouch\" && animationName !== \"crawl\") {\r\n      this.setCrouch(false);\r\n    }\r\n    var oldAnimation = this.animation;\r\n\r\n    this.animation = this.animations[animationName];\r\n    this.animationName = animationName;\r\n    this.animationTick = 0;\r\n\r\n    if (this.animation.size) {\r\n      this.w = this.animation.size[0];\r\n      this.h = this.animation.size[1];\r\n\r\n      this.x += (this.defaultSize[0] - this.animation.size[0]) / 2;\r\n      this.y += this.defaultSize[1] - this.animation.size[1];\r\n    } else {\r\n      [this.w, this.h] = this.defaultSize;\r\n\r\n      if (fixSize) {\r\n        if (oldAnimation && oldAnimation.size) {\r\n          this.x -= (this.w - oldAnimation.size[0]) / 2;\r\n          this.y -= this.h - oldAnimation.size[1];\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  attack() {\r\n    this.game.camera.shake(0.15, 0.8);\r\n\r\n    this.setAnimation(\"attack1\");\r\n  }\r\n\r\n  groundSlam() {\r\n    this.setAnimation(\"ground_slam\");\r\n  }\r\n\r\n  jump() {\r\n    if (this.doubleJumped && !this.ledgeHang) {\r\n      return\r\n    }\r\n    this.gravityTick = 0;\r\n    this.velocityX = 0;\r\n\r\n    this.lastLandY = null;\r\n\r\n    this.game.particleSystem.spawnParticles(\r\n      this.getCenter()[0],\r\n      this.getBottom() - 0.1,\r\n      4,\r\n      0.3\r\n    );\r\n\r\n    if (!this.onGround) {\r\n      this.setAnimation(\"roll\");\r\n      this.ledgeHang = false;\r\n      this.doubleJumped = true;\r\n\r\n      this.velocityY = -4.85;\r\n    } else {\r\n      this.setAnimation(\"jump\");\r\n      this.velocityY = -5;\r\n    }\r\n  }\r\n\r\n  slide() {\r\n    if (this.animations.slide.timeout) {\r\n      //prevent double sliding\r\n      return\r\n    }\r\n    this.animations.slide.timeout = true;\r\n    setTimeout(() => {\r\n      this.animations.slide.timeout = false;\r\n    }, 1500)\r\n    this.setAnimation(\"slide\");\r\n  }\r\n\r\n  knockback() {\r\n    this.setAnimation(\"knockback\");\r\n    setTimeout(() => {\r\n      this.velocityX = 0.1 * (this.facing == 0 ? 1 : -1);\r\n    }, 100);\r\n  }\r\n\r\n  render(delta) {\r\n    // animator\r\n    this.animationTick += delta * 1000;\r\n\r\n    var index = Math.floor(this.animationTick / this.animation.speed);\r\n    var done = false;\r\n    if (index > this.animation.frames.length - 1) {\r\n      if (index > this.animation.frames.length) {\r\n        done = true;\r\n      }\r\n\r\n      index = this.animation.frames.length - 1;\r\n    }\r\n\r\n    var frame = this.animation.frames[index];\r\n\r\n    if (this.game.showInfo) {\r\n      this.game.render.drawRect(\r\n        this.x,\r\n        this.y,\r\n        this.w,\r\n        this.h,\r\n        this.onGround ? \"#444\" : \"#663333\"\r\n      );\r\n    }\r\n\r\n    var xOffset = 0;\r\n\r\n    var [w, h] = this.defaultSize;\r\n\r\n    this.game.render.drawSprite(\r\n      {\r\n        sprite: this.animation.sprite,\r\n        frame: frame,\r\n        effects: this.facing == 0 ? [\"flipHorizontally\"] : [],\r\n      },\r\n      this.x -\r\n        w * 1.55 +\r\n        (Array.isArray(this.animation.xOffset)\r\n          ? this.animation.xOffset[this.facing]\r\n          : this.animation.xOffset) +\r\n        xOffset,\r\n      this.y - h * 1.05 + this.animation.yOffset,\r\n      w * h * 4.3,\r\n      w * h * 4.3 * 0.875\r\n    );\r\n\r\n    if (done) {\r\n      if (this.animation.after) {\r\n        if (this.animationName === \"idle\" && Math.random() > 0.5) {\r\n          this.setAnimation(\"look_up\");\r\n        } else {\r\n          this.setAnimation(this.animation.after);\r\n        }\r\n      } else {\r\n        this.setAnimation(this.animationName);\r\n      }\r\n    }\r\n\r\n    // animation logic\r\n    if (this.running) {\r\n      if (this.animation.idle) {\r\n        this.setAnimation(\"run\");\r\n      }\r\n      if (this.animationName === \"crouch\") {\r\n        this.setAnimation(\"crawl\");\r\n      }\r\n    } else {\r\n      if (this.animationName === \"run\") {\r\n        this.setAnimation(\"idle\");\r\n      }\r\n      if (this.animationName === \"crawl\") {\r\n        this.setAnimation(\"crouch\");\r\n      }\r\n    }\r\n\r\n    if (!this.onGround) {\r\n      if (\r\n        this.animation.idle ||\r\n        (!this.ledgeHang && this.animationName === \"ledge_hang\")\r\n      ) {\r\n        this.setAnimation(\"fall\");\r\n      }\r\n    } else {\r\n      if (this.animationName === \"fall\") {\r\n        this.setAnimation(\"idle\");\r\n      }\r\n    }\r\n  }\r\n\r\n  update(delta) {\r\n    var wasOnGround = this.onGround;\r\n\r\n    super.update(delta);\r\n\r\n    if (!this.onGround && !this.ledgeHang) {\r\n      this.gravityTick += delta;\r\n      this.y += Math.min(this.gravityTick / 5, delta * 10);\r\n    } else {\r\n      this.gravityTick = 0;\r\n    }\r\n    if (!this.animationName.includes(\"slide\")) {\r\n      this.frictionValue = 0;\r\n    } else {\r\n      this.velocityX = Math.sqrt(-0.07 * this.frictionValue + 3) * (this.facing == 0 ? -1 : 1);\r\n      this.frictionValue++\r\n    }\r\n    if (this.onGround) {\r\n      //resetting movement checks\r\n      this.doubleJumped = false\r\n\r\n      if (!wasOnGround) {\r\n        var y = Math.floor(this.y);\r\n        if (y !== this.lastLandY) {\r\n          this.lastLandY = y;\r\n\r\n          this.game.particleSystem.spawnParticles(\r\n            this.getCenter()[0],\r\n            this.getBottom() - 0.1,\r\n            5,\r\n            0.3\r\n          );\r\n\r\n          if (this.velocityY < 0) {\r\n            this.velocityY = 0;\r\n          } else {\r\n          }\r\n          if (\r\n            this.animationName !== \"ground_slam\" &&\r\n            this.animationName !== \"knockback\"\r\n          ) {\r\n            this.setAnimation(\"land\", true);\r\n          } else {\r\n            this.game.camera.shake(0.1, 4);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // game boundaries\r\n    this.x = Math.max(0, Math.min(this.game.levelWidth - this.w, this.x));\r\n    this.y = Math.max(0, Math.min(this.game.levelHeight - this.h, this.y));\r\n  }\r\n}\r\n","import Game from \"./Game.js\";\r\nimport { degreesToRadians } from \"./util/MathUtil.js\";\r\n\r\nexport default class Render {\r\n  /**\r\n   * @param {Game} game\r\n   */\r\n  constructor(game) {\r\n    this.game = game;\r\n  }\r\n\r\n  setAlpha(alpha) {\r\n    this.game.ctx.globalAlpha = alpha;\r\n  }\r\n\r\n  drawLine(startX, startY, endX, endY, strokeWidth, color) {\r\n    this.game.ctx.strokeStyle = color;\r\n\r\n    this.game.ctx.beginPath();\r\n    this.game.ctx.moveTo(\r\n      ...this.game.camera.transformCoordinates(startX, startY)\r\n    );\r\n    this.game.ctx.lineTo(...this.game.camera.transformCoordinates(endX, endY));\r\n    this.game.ctx.lineWidth = this.game.camera.transformX(strokeWidth);\r\n\r\n    this.game.ctx.stroke();\r\n    this.game.ctx.closePath();\r\n  }\r\n\r\n  drawRect(x, y, w, h, color) {\r\n    this.game.ctx.fillStyle = color;\r\n    this.game.ctx.fillRect(...this.game.camera.transformRect(x, y, w, h));\r\n  }\r\n\r\n  drawCircle(x, y, r, color) {\r\n    this.game.ctx.fillStyle = color;\r\n    this.game.ctx.beginPath();\r\n    this.game.ctx.arc(\r\n      ...this.game.camera.transformCoordinates(x, y),\r\n      this.game.camera.transformX(r),\r\n      2 * Math.PI,\r\n      0\r\n    );\r\n    this.game.ctx.fill();\r\n    this.game.ctx.closePath();\r\n  }\r\n\r\n  /**\r\n   * @param {Object} spriteInfo\r\n   * @param {string} spriteInfo.sprite\r\n   * @param {number} spriteInfo.frame\r\n   * @param {string[]} spriteInfo.effects\r\n   * @param {number} x\r\n   * @param {number} y\r\n   * @param {number} w\r\n   * @param {number} h\r\n   */\r\n  drawSprite(spriteInfo, x, y, w, h) {\r\n    var sprite = this.game.ssm.getSpriteFromInfoObject(spriteInfo);\r\n\r\n    if (sprite) {\r\n      this.drawScalingSprite(spriteInfo, x, y, w, h);\r\n\r\n      var aspectRatio = sprite.h / sprite.w;\r\n      var passedAspectRatio = h / w;\r\n\r\n      if (aspectRatio.toFixed(2) !== passedAspectRatio.toFixed(2)) {\r\n        throw new Error(\r\n          \"Invalid aspect ratio while drawing \" +\r\n            JSON.stringify(spriteInfo) +\r\n            \", expected: \" +\r\n            aspectRatio +\r\n            \", received: \" +\r\n            passedAspectRatio\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  drawScalingSprite(spriteInfo, x, y, w, h) {\r\n    var sprite = this.game.ssm.getSpriteFromInfoObject(spriteInfo);\r\n\r\n    if (sprite) {\r\n      this.drawImage(\r\n        sprite.spriteSheet.image,\r\n        x,\r\n        y,\r\n        w,\r\n        h,\r\n        sprite.x,\r\n        sprite.y,\r\n        sprite.w,\r\n        sprite.h\r\n      );\r\n    }\r\n  }\r\n\r\n  drawImage(img, x, y, w, h, sx, sy, sw, sh) {\r\n    this.game.ctx.drawImage(\r\n      img,\r\n      sx,\r\n      sy,\r\n      sw,\r\n      sh,\r\n      ...this.game.camera.transformRect(x, y, w, h).map(Math.round)\r\n    );\r\n  }\r\n\r\n  drawImageWithRotation(image, _x, _y, _w, _h, sx, sy, sw, sh, rotateDegrees) {\r\n    var [x, y, width, height] = this.game.camera.transformRect(_x, _y, _w, _h);\r\n\r\n    x += width / 2;\r\n    y += height / 2;\r\n\r\n    var context = this.game.ctx;\r\n\r\n    var angleInRadians = degreesToRadians(rotateDegrees);\r\n\r\n    context.translate(x, y);\r\n    context.rotate(angleInRadians);\r\n    context.drawImage(\r\n      image,\r\n      sx,\r\n      sy,\r\n      sw,\r\n      sh,\r\n      -width / 2,\r\n      -height / 2,\r\n      width,\r\n      height\r\n    );\r\n    context.rotate(-angleInRadians);\r\n    context.translate(-x, -y);\r\n  }\r\n\r\n  drawText(text, x, y, fontSize, color) {\r\n    this.game.ctx.fillStyle = color;\r\n    this.game.ctx.font = fontSize + \"px\";\r\n\r\n    this.game.ctx.fillText(\r\n      text,\r\n      ...this.game.camera.transformCoordinates(x, y)\r\n    );\r\n  }\r\n\r\n  drawScalingText(text, x, y, maxX, fontSize, color) {\r\n    this.game.ctx.fillStyle = color;\r\n    this.game.ctx.font = fontSize + \"px\";\r\n\r\n    this.game.ctx.fillText(\r\n      text,\r\n      ...this.game.camera.transformCoordinates(x, y),\r\n      this.game.camera.transformX(maxX)\r\n    );\r\n  }\r\n}\r\n","import Sprite from \"./Sprite\";\r\nimport SpriteSheet from \"./SpriteSheet\";\r\n\r\nexport default class ImageEffects {\r\n  constructor() {\r\n    this.canvas = document.createElement(\"canvas\");\r\n    this.ctx = this.canvas.getContext(\"2d\");\r\n  }\r\n\r\n  async applyEffectsToSpriteSheet(spriteSheet, effects) {\r\n    if (!effects.length) {\r\n      return spriteSheet;\r\n    }\r\n\r\n    var images = new Map();\r\n    var firstImage;\r\n    var clonedSprites = {};\r\n\r\n    for (var spriteName in spriteSheet.sprites) {\r\n      var sprite = spriteSheet.sprites[spriteName];\r\n      var image = sprite.spriteSheet.image;\r\n\r\n      var clonedSprite = new Sprite(sprite, sprite.spriteSheet);\r\n      clonedSprites[spriteName] = clonedSprite;\r\n\r\n      if (!firstImage) {\r\n        firstImage = image;\r\n      }\r\n\r\n      if (!images.has(image)) {\r\n        images.set(image, [clonedSprite]);\r\n      } else {\r\n        images.get(image).push(clonedSprite);\r\n      }\r\n    }\r\n\r\n    var topLevel = new SpriteSheet(\r\n      await this.applyEffectsToImage(firstImage, effects),\r\n      {\r\n        type: \"manual\",\r\n        sprites: {},\r\n      },\r\n      spriteSheet.ssm,\r\n      false\r\n    );\r\n\r\n    topLevel.sprites = clonedSprites;\r\n\r\n    for (var image of images.keys()) {\r\n      var sprites = images.get(image);\r\n\r\n      var newImage = await this.applyEffectsToImage(image, effects);\r\n      var newSpriteSheet = new SpriteSheet(\r\n        newImage,\r\n        {\r\n          type: \"manual\",\r\n          sprites: {},\r\n        },\r\n        spriteSheet.ssm,\r\n        false\r\n      );\r\n\r\n      newSpriteSheet.sprites = sprites;\r\n\r\n      for (var sprite of sprites) {\r\n        sprite.spriteSheet = newSpriteSheet;\r\n      }\r\n    }\r\n\r\n    return topLevel;\r\n  }\r\n\r\n  async applyEffectsToImage(image, effects) {\r\n    if (!effects.length) {\r\n      return image;\r\n    }\r\n\r\n    var currentImage = image;\r\n    for (var effect of effects) {\r\n      currentImage = await this.applyEffectToImage(currentImage, effect);\r\n    }\r\n\r\n    return currentImage;\r\n  }\r\n\r\n  async applyEffectToImage(image, effect) {\r\n    return new Promise((resolve, reject) => {\r\n      var effectName = typeof effect === \"string\" ? effect : effect.name;\r\n\r\n      // prepare canvas\r\n      this.canvas.width = image.width;\r\n      this.canvas.height = image.height;\r\n\r\n      this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n\r\n      switch (effectName) {\r\n        case \"flipHorizontally\":\r\n          this.flipHorizontally(image);\r\n          break;\r\n\r\n        case \"teamColor\":\r\n          this.teamColor(image, effect.payload);\r\n          break;\r\n\r\n        default:\r\n          throw new Error(\"Invalid effect name \" + effectName);\r\n      }\r\n\r\n      let outputImage = new Image();\r\n\r\n      var dataURL = this.canvas.toDataURL(\"image/png\");\r\n\r\n      outputImage.src = dataURL;\r\n      outputImage.onload = () => {\r\n        outputImage.loaded = true;\r\n\r\n        resolve(outputImage);\r\n      };\r\n    });\r\n  }\r\n\r\n  teamColor(image, color = \"#ff2222\") {\r\n    var ctx = this.ctx,\r\n      canvas = this.canvas;\r\n\r\n    if (Array.isArray(color)) {\r\n      color = \"rgb(\" + color.join(\",\") + \")\";\r\n    }\r\n    /// ... var color = colors[index];\r\n\r\n    this.canvas.width = image.width;\r\n    this.canvas.height = image.height;\r\n\r\n    // First draw your image to the buffer\r\n    ctx.drawImage(image, 0, 0);\r\n\r\n    // Now we'll multiply a rectangle of your chosen color\r\n\r\n    ctx.globalCompositeOperation = \"darken\";\r\n\r\n    ctx.fillStyle = color;\r\n\r\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n    // Finally, fix masking issues you'll probably incur and optional globalAlpha\r\n    ctx.globalAlpha = 1;\r\n    ctx.globalCompositeOperation = \"destination-in\";\r\n    ctx.drawImage(image, 0, 0);\r\n  }\r\n\r\n  /**\r\n   * @param {Image} image\r\n   */\r\n  flipHorizontally(image) {\r\n    this.canvas.width = image.width;\r\n    this.canvas.height = image.height;\r\n\r\n    const flipHorizontally = (img, x, y) => {\r\n      // move to x + img's width\r\n      this.ctx.translate(x + img.width, y);\r\n\r\n      // scaleX by -1; this \"trick\" flips horizontally\r\n      this.ctx.scale(-1, 1);\r\n\r\n      // draw the img\r\n      // no need for x,y since we've already translated\r\n      this.ctx.drawImage(img, 0, 0);\r\n\r\n      // always clean up -- reset transformations to default\r\n      this.ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n    };\r\n\r\n    flipHorizontally(image, 0, 0);\r\n  }\r\n}\r\n","import ImageEffects from \"./ImageEffects\";\r\nimport Sprite from \"./Sprite\";\r\nimport SpriteSheetManager from \"./SpriteSheetManager\";\r\n\r\nconst SPRITE_PATH = process.env.PUBLIC_URL + \"/sprites/\";\r\n\r\nexport default class SpriteSheet {\r\n  constructor(imgPath, info, spriteSheetManager, isTopLevel = true) {\r\n    if (\r\n      !spriteSheetManager ||\r\n      !(spriteSheetManager instanceof SpriteSheetManager)\r\n    ) {\r\n      throw new Error(\"Invalid spriteSheetManager\");\r\n    }\r\n\r\n    /**\r\n     * @type {Object.<string, Sprite>}\r\n     */\r\n    this.sprites = {};\r\n    this.ssm = spriteSheetManager;\r\n    this.effectsCache = {};\r\n    this.creating = {};\r\n\r\n    this.name = \"\";\r\n\r\n    this.image = imgPath instanceof Image ? imgPath : new Image();\r\n\r\n    if (typeof imgPath === \"string\") {\r\n      this.image.src = SPRITE_PATH + imgPath;\r\n    }\r\n\r\n    this.image.addEventListener(\"error\", (e) => {\r\n      console.log(\"Error loading \" + this.image.src, e);\r\n    });\r\n\r\n    this.image.addEventListener(\"load\", () => {\r\n      this.image.loaded = true;\r\n      if (isTopLevel) {\r\n        this.ssm.incrementLoaded();\r\n      }\r\n\r\n      if (info.type === \"auto\") {\r\n        if (!info.width || !info.height) {\r\n          throw new Error(\r\n            \"Invalid width/height on info \" + JSON.stringify(info)\r\n          );\r\n        }\r\n\r\n        var width = info.width;\r\n        var height = info.height;\r\n\r\n        var border = info.border || 0;\r\n\r\n        var imageWidth = this.image.width - border * 2;\r\n        var imageHeight = this.image.height - border * 2;\r\n\r\n        if (width > imageWidth) {\r\n          throw new Error(\r\n            imgPath +\r\n              \" invalid sprite width \" +\r\n              width +\r\n              \" when image is \" +\r\n              imageWidth +\r\n              \"px wide\"\r\n          );\r\n        }\r\n\r\n        if (height > imageHeight) {\r\n          throw new Error(\r\n            imgPath +\r\n              \" invalid sprite height \" +\r\n              width +\r\n              \" when image is \" +\r\n              imageHeight +\r\n              \"px tall\"\r\n          );\r\n        }\r\n\r\n        var x = 0;\r\n        var y = 0;\r\n        var i = 0;\r\n        while (true) {\r\n          this.sprites[i] = new Sprite(\r\n            {\r\n              x: x,\r\n              y: y,\r\n              w: width,\r\n              h: height,\r\n            },\r\n            this\r\n          );\r\n\r\n          i++;\r\n          x += width;\r\n          if (x >= imageWidth) {\r\n            x = border;\r\n            y += height;\r\n          }\r\n\r\n          if (y >= imageHeight) {\r\n            break;\r\n          }\r\n        }\r\n      } else if (info.type === \"manual\") {\r\n        if (!info.sprites) {\r\n          throw new Error(\"Invalid sprites on info \" + JSON.stringify(info));\r\n        }\r\n\r\n        var sprites = info.sprites;\r\n        for (var spriteName in sprites) {\r\n          this.sprites[spriteName] = new Sprite(sprites[spriteName], this);\r\n        }\r\n      } else if (info.type === \"increment_file_name\") {\r\n        var prefix = imgPath.split(\"1.png\")[0];\r\n        var suffix = \".png\";\r\n\r\n        if (!imgPath.includes(\"1.png\")) {\r\n          throw new Error(\"Invalid path\");\r\n        }\r\n\r\n        this.sprites[0] = new Sprite(\r\n          {\r\n            x: 0,\r\n            y: 0,\r\n            w: this.image.width,\r\n            h: this.image.height,\r\n          },\r\n          this\r\n        );\r\n\r\n        for (var i = 2; i <= info.max; i++) {\r\n          ((i) => {\r\n            // Placeholder sprite while it loads\r\n\r\n            var newImageSRC = prefix + i + suffix;\r\n\r\n            var childSprite = new Sprite(\r\n              {\r\n                x: 0,\r\n                y: 0,\r\n                w: this.image.width,\r\n                h: this.image.height,\r\n              },\r\n              new SpriteSheet(\r\n                newImageSRC,\r\n                {\r\n                  type: \"single\",\r\n                },\r\n                this.ssm\r\n              )\r\n            );\r\n\r\n            childSprite.indirect = true;\r\n\r\n            this.sprites[i - 1] = childSprite;\r\n          })(i);\r\n        }\r\n      } else if (info.type === \"single\") {\r\n        this.sprites = {\r\n          0: new Sprite(\r\n            {\r\n              x: 0,\r\n              y: 0,\r\n              w: this.image.width,\r\n              h: this.image.height,\r\n            },\r\n            this\r\n          ),\r\n        };\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @param {string} spriteName\r\n   * @returns {Sprite}\r\n   */\r\n  getSprite(spriteName) {\r\n    var sprite = this.sprites[spriteName];\r\n    if (!sprite) {\r\n      throw new Error(\r\n        \"Invalid sprite: \" +\r\n          spriteName +\r\n          \" (\" +\r\n          this.name +\r\n          \") [\" +\r\n          Object.keys(this.sprites).join(\",\") +\r\n          \"]\"\r\n      );\r\n    }\r\n\r\n    return sprite;\r\n  }\r\n\r\n  getEffects(effects) {\r\n    if (!effects.length) {\r\n      return this;\r\n    }\r\n\r\n    var name = JSON.stringify(effects);\r\n\r\n    if (this.effectsCache[name]) {\r\n      return this.effectsCache[name];\r\n    }\r\n    if (this.creating[name]) {\r\n      return this;\r\n    }\r\n\r\n    this.creating[name] = true;\r\n\r\n    (async () => {\r\n      var imageEffects = new ImageEffects();\r\n      var newSpriteSheet = await imageEffects.applyEffectsToSpriteSheet(\r\n        this,\r\n        effects\r\n      );\r\n\r\n      if (!(newSpriteSheet instanceof SpriteSheet)) {\r\n        throw new Error(\"Expected SpriteSheet\");\r\n      }\r\n\r\n      this.effectsCache[name] = newSpriteSheet;\r\n      this.creating[name] = false;\r\n    })();\r\n\r\n    return this;\r\n  }\r\n}\r\n","import SpriteSheet from \"./SpriteSheet\";\r\n\r\nexport default class Sprite {\r\n  constructor(spriteInfo, spriteSheet) {\r\n    if (!(spriteSheet instanceof SpriteSheet)) {\r\n      throw new Error(\"Invalid sprite sheet\");\r\n    }\r\n\r\n    this.x = spriteInfo.x || 0;\r\n    this.y = spriteInfo.y || 0;\r\n    this.w = spriteInfo.w || 0;\r\n    this.h = spriteInfo.h || 0;\r\n\r\n    /**\r\n     * @type {SpriteSheet}\r\n     */\r\n    this.spriteSheet = spriteSheet;\r\n  }\r\n}\r\n","import Sprite from \"./Sprite.js\";\r\nimport SpriteSheet from \"./SpriteSheet.js\";\r\n\r\nexport default class SpriteSheetManager {\r\n  constructor() {\r\n    /**\r\n     * @type {Object.<string, SpriteSheet>}\r\n     */\r\n    this.spriteSheets = {};\r\n\r\n    this.assetsLoaded = 0;\r\n    this.assetsTotal = 0;\r\n    this.hasLoaded = false;\r\n    this.onLoaded = () => {};\r\n  }\r\n\r\n  incrementLoaded() {\r\n    this.assetsLoaded++;\r\n\r\n    console.log(this.assetsLoaded, this.assetsTotal);\r\n\r\n    setTimeout(() => {\r\n      if (this.assetsLoaded === this.assetsTotal) {\r\n        if (!this.hasLoaded) {\r\n          this.hasLoaded = true;\r\n          this.onLoaded();\r\n        }\r\n      }\r\n    }, 90);\r\n  }\r\n\r\n  addSpriteSheet(name, imgPath, info) {\r\n    var ss = new SpriteSheet(imgPath, info, this);\r\n    ss.name = name;\r\n\r\n    if (info.type === \"increment_file_name\") {\r\n      this.assetsTotal += info.max;\r\n    } else {\r\n      this.assetsTotal += 1;\r\n    }\r\n\r\n    this.spriteSheets[name] = ss;\r\n    return ss;\r\n  }\r\n\r\n  /**\r\n   * @param {string} spriteSheetName\r\n   * @returns {SpriteSheet}\r\n   */\r\n  getSpriteSheet(spriteSheetName) {\r\n    if (!this.spriteSheets[spriteSheetName]) {\r\n      throw new Error(\"Invalid sprite sheet: \" + spriteSheetName);\r\n    }\r\n    return this.spriteSheets[spriteSheetName];\r\n  }\r\n\r\n  /**\r\n   * @param {string} path\r\n   * @returns {Sprite}\r\n   */\r\n  getSprite(path) {\r\n    var spriteSheetName = path.split(\":\")[0];\r\n    var spriteName = path.split(\":\")[1];\r\n\r\n    return this.getSpriteSheet(spriteSheetName).getSprite(spriteName);\r\n  }\r\n\r\n  /**\r\n   * @param {Object} spriteInfo\r\n   * @param {string} spriteInfo.sprite\r\n   * @param {number} spriteInfo.frame\r\n   * @param {string[]} spriteInfo.effects\r\n   * @returns {Sprite}\r\n   */\r\n  getSpriteFromInfoObject(spriteInfo) {\r\n    var sprite = spriteInfo.sprite;\r\n    var frame = spriteInfo.frame;\r\n\r\n    var effects = spriteInfo.effects || [];\r\n\r\n    var spriteSheet = this.getSpriteSheet(sprite).getEffects(effects);\r\n\r\n    if (spriteSheet) {\r\n      return spriteSheet.getSprite(frame);\r\n    } else {\r\n      throw new Error(\"No sprite sheet\");\r\n    }\r\n  }\r\n}\r\n","import Camera from \"./Camera\";\r\nimport Controller from \"./Controller\";\r\nimport Entity from \"./Entity\";\r\nimport InputManager from \"./InputManager\";\r\nimport ParticleSystem from \"./ParticleSystem\";\r\nimport Player from \"./Player\";\r\nimport Render from \"./Render\";\r\nimport SpriteSheetManager from \"./SpriteSheetManager\";\r\nimport { v4 } from \"uuid\";\r\nimport { getRandomInteger } from \"./random\";\r\n\r\nexport default class Game {\r\n  constructor(canvas, ctx, ssm) {\r\n    /**\r\n     * @type {HTMLCanvasElement}\r\n     */\r\n    this.canvas = canvas;\r\n\r\n    /**\r\n     * @type {CanvasRenderingContext2D}\r\n     */\r\n    this.ctx = ctx;\r\n\r\n    /**\r\n     * @type {SpriteSheetManager}\r\n     */\r\n    this.ssm = ssm;\r\n\r\n    this.render = new Render(this);\r\n    this.camera = new Camera(this);\r\n\r\n    this.inputManager = new InputManager();\r\n    this.particleSystem = new ParticleSystem(this);\r\n\r\n    this.player = new Player(this);\r\n    this.controller = new Controller(this);\r\n\r\n    /**\r\n     * @type {Object.<string, Entity>}\r\n     */\r\n    this.entities = {};\r\n\r\n    const level = [\r\n      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n      [0, 0, 0, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n      [0, 5, 0, 5, 0, 0, 0, 0, 5, 5, 5, 5, 0, 0, 0],\r\n      [0, 5, 0, 5, 0, 0, 0, 0, 0, 0, 0, 5, 0, 0, 0],\r\n      [0, 5, 0, 5, 0, 5, 5, 0, 0, 0, 0, 5, 0, 0, 0],\r\n      [0, 5, 0, 0, 0, 5, 0, 0, 0, 0, 0, 5, 0, 0, 0],\r\n      [0, 5, 5, 5, 5, 5, 0, 0, 5, 5, 5, 5, 0, 0, 0],\r\n      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 5, 0, 0],\r\n      [0, 0, 0, 5, 5, 5, 5, 0, 0, 0, 0, 0, 5, 5, 0],\r\n      [0, 0, 0, 0, 5, 5, 0, 0, 0, 0, 0, 0, 0, 5, 5],\r\n      [0, 0, 0, 0, 0, 5, 5, 5, 0, 0, 0, 0, 0, 0, 0],\r\n      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n      [0, 5, 0, 0, 0, 0, 5, 5, 5, 5, 0, 0, 0, 0, 0],\r\n      [5, 5, 5, 0, 0, 0, 0, 0, 0, 5, 5, 0, 0, 0, 0],\r\n      [0, 5, 0, 0, 0, 0, 0, 0, 0, 0, 5, 5, 0, 0, 0],\r\n      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n      [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\r\n      [5, 5, 5, 0, 5, 5, 5, 5, 5, 0, 5, 5, 5, 5, 5],\r\n      [5, 5, 5, 0, 5, 5, 5, 5, 5, 0, 5, 5, 5, 5, 5],\r\n      [5, 5, 5, 0, 5, 5, 5, 5, 5, 0, 5, 5, 5, 5, 5],\r\n      [5, 5, 5, 0, 5, 5, 5, 5, 5, 0, 5, 5, 5, 5, 5],\r\n      [5, 5, 5, 0, 0, 0, 5, 5, 0, 0, 0, 5, 5, 5, 5],\r\n      [5, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 5, 5],\r\n      [5, 5, 5, 5, 5, 0, 0, 0, 0, 0, 0, 0, 5, 5, 5],\r\n      [5, 5, 5, 5, 5, 0, 0, 0, 0, 0, 0, 5, 5, 5, 5],\r\n      [5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5],\r\n    ];\r\n\r\n    this.showInfo = false;\r\n    this.map = level.flat(1);\r\n\r\n    this.levelWidth = level[0].length;\r\n    this.levelHeight = level.length;\r\n    this.camera.endY = this.levelHeight - 7;\r\n    this.camera.startY = this.levelHeight - 15;\r\n    this.camera.maxY = this.levelHeight;\r\n    this.camera.minX = 0;\r\n\r\n    this.player.y = this.levelHeight - 12;\r\n\r\n    this.spawnTick = 0;\r\n    this.fpsTick = 0;\r\n    this.fps = 0;\r\n\r\n    if (this.map.length !== this.levelWidth * this.levelHeight) {\r\n      throw new Error(\"Invalid map length: \" + this.map.length);\r\n    }\r\n\r\n    /**\r\n     * - `0` = No collision\r\n     * - `1` = Left\r\n     * - `2` = Right\r\n     * - `4` = Top\r\n     * - `8` = Bottom\r\n     */\r\n    this.collisionMap = this.createCollisionMap();\r\n  }\r\n\r\n  end() {\r\n    this.inputManager.end();\r\n  }\r\n\r\n  spawnEntity() {\r\n    var id = v4();\r\n\r\n    var entity = new Entity(this);\r\n    this.entities[id] = entity;\r\n\r\n    var direction = Math.random() > 0.5 ? -1 : 1;\r\n\r\n    if (this.camera.startX <= 0) {\r\n      direction = 1;\r\n    }\r\n\r\n    if (direction === -1) {\r\n      entity.x = this.camera.endX + 2;\r\n    } else {\r\n      entity.x = this.camera.startX - 2;\r\n    }\r\n\r\n    entity.direction = direction;\r\n\r\n    entity.y = this.player.y + getRandomInteger(-2, 2);\r\n  }\r\n\r\n  createCollisionMap() {\r\n    var collisionMap = [];\r\n\r\n    for (var i = 0; i < this.map.length; i++) {\r\n      var block = this.map[i];\r\n\r\n      var flag = 0;\r\n\r\n      if (block) {\r\n        var [x, y] = this.convertIndexToCoordinates(i);\r\n        var top = this.map[this.convertCoordinatesToIndex(x, y - 1)];\r\n        var bottom = this.map[this.convertCoordinatesToIndex(x, y + 1)];\r\n\r\n        var left = this.map[this.convertCoordinatesToIndex(x - 1, y)];\r\n        var right = this.map[this.convertCoordinatesToIndex(x + 1, y)];\r\n\r\n        if (x !== 0) {\r\n          flag |= !left ? 1 : 0;\r\n        }\r\n        if (x !== this.levelWidth - 1) {\r\n          flag |= !right ? 2 : 0;\r\n        }\r\n        if (y !== 0) {\r\n          flag |= !top ? 4 : 0;\r\n        }\r\n        if (y !== this.levelHeight - 1) {\r\n          flag |= !bottom ? 8 : 0;\r\n        }\r\n      }\r\n\r\n      collisionMap.push(flag);\r\n    }\r\n\r\n    return collisionMap;\r\n  }\r\n\r\n  getViewport() {\r\n    return [this.canvas.width, this.canvas.height];\r\n  }\r\n\r\n  start() {\r\n    this.inputManager.start();\r\n    this.particleSystem.particles = [];\r\n\r\n    this.camera.followingObject = this.player;\r\n  }\r\n\r\n  convertIndexToCoordinates(i) {\r\n    return [i % this.levelWidth, Math.floor(i / this.levelWidth)];\r\n  }\r\n\r\n  convertCoordinatesToIndex(x, y) {\r\n    return y * this.levelWidth + x;\r\n  }\r\n\r\n  renderGame(delta) {\r\n    // this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n\r\n    // var spriteSheet = this.ssm.getSpriteSheet(\"tile\");\r\n\r\n    // var sprites = Object.keys(spriteSheet.sprites);\r\n\r\n    // var gap = 0.05;\r\n\r\n    // var x = this.camera.startX + gap,\r\n    //   y = this.camera.startY + gap;\r\n\r\n    // for (var spriteName of sprites) {\r\n    //   var sprite = spriteSheet.sprites[spriteName];\r\n\r\n    //   var w = sprite.w / 100;\r\n    //   var h = sprite.h / 100;\r\n\r\n    //   this.render.drawRect(x, y, w, h, \"#fff\");\r\n\r\n    //   this.render.drawSprite(\r\n    //     {\r\n    //       sprite: spriteSheet.name,\r\n    //       frame: spriteName,\r\n    //       effects: [],\r\n    //     },\r\n    //     x,\r\n    //     y,\r\n    //     w,\r\n    //     h\r\n    //   );\r\n\r\n    //   this.render.drawText(spriteName, x, y + 0.1, \"14\", \"#444499\");\r\n\r\n    //   x += h + gap;\r\n    //   if (x >= this.camera.getWidth() - gap) {\r\n    //     x = this.camera.startX + gap;\r\n    //     y += h + gap;\r\n    //   }\r\n    // }\r\n\r\n    // for (var i = 0; i < 3; i++) {\r\n    //   var pow = ((1 / (4 - i)) * 1) / (4 - i);\r\n    //   var h = this.levelHeight;\r\n    //   var x =\r\n    //     -this.levelHeight +\r\n    //     -this.camera.getCenter()[0] * pow +\r\n    //     this.camera.getCenter()[0];\r\n    //   var w = h / 0.5625;\r\n    //   while (x < this.camera.endX) {\r\n    //     this.render.drawSprite(\r\n    //       {\r\n    //         sprite: \"background\",\r\n    //         frame: i,\r\n    //       },\r\n    //       x,\r\n    //       this.camera.startY,\r\n    //       w,\r\n    //       h\r\n    //     );\r\n    //     x += w;\r\n    //   }\r\n    // }\r\n\r\n    // for (var i = 0; i < this.map.length; i++) {\r\n    //   var block = this.map[i];\r\n    //   if (block) {\r\n    //     var [x, y] = this.convertIndexToCoordinates(i);\r\n    //     // this.render.drawRect(x - 0.01, y - 0.01, 1.02, 1.02, \"#333\");\r\n    //     this.render.drawSprite(\r\n    //       {\r\n    //         sprite: \"tile\",\r\n    //         frame: block - 1,\r\n    //         effects: [],\r\n    //       },\r\n    //       x,\r\n    //       y,\r\n    //       1,\r\n    //       1\r\n    //     );\r\n    //   }\r\n    // }\r\n\r\n    this.ctx.fillStyle = \"#fff\";\r\n    this.ctx.font = \"20px Readex Pro\";\r\n    this.ctx.fillText(this.fps + \"\", 5, 20);\r\n    this.ctx.font = \"14px Readex Pro\";\r\n\r\n    this.player.render(delta);\r\n    for (var entityUUID in this.entities) {\r\n      var entity = this.entities[entityUUID];\r\n\r\n      entity.render(delta);\r\n    }\r\n\r\n    for (var i = 0; i < this.map.length; i++) {\r\n      var collisionFlag = this.collisionMap[i];\r\n      var [x, y] = this.convertIndexToCoordinates(i);\r\n\r\n      if (\r\n        x + 1 > this.camera.startX &&\r\n        y + 1 > this.camera.startY &&\r\n        x <= this.camera.endX &&\r\n        y <= this.camera.endY\r\n      ) {\r\n        var color = \"#fff\";\r\n\r\n        var width = 0.025;\r\n\r\n        if (collisionFlag & 1) {\r\n          this.render.drawRect(x, y, width, 1, color);\r\n          this.render.drawText(\"1\", x + 0.1, y + 0.53, 14);\r\n        }\r\n        if (collisionFlag & 2) {\r\n          this.render.drawRect(x + (1 - width), y, width, 1, color);\r\n          this.render.drawText(\"2\", x + 0.82, y + 0.53, 14);\r\n        }\r\n        if (collisionFlag & 4) {\r\n          this.render.drawRect(x, y, 1, width, color);\r\n          this.render.drawText(\"4\", x + 0.49, y + 0.2, 14);\r\n        }\r\n        if (collisionFlag & 8) {\r\n          this.render.drawRect(x, y + (1 - width), 1, width, color);\r\n          this.render.drawText(\"8\", x + 0.49, y + 0.92, 14);\r\n        }\r\n      }\r\n    }\r\n\r\n    var tileKeys = Object.keys(this.player.tiles);\r\n    for (var i = 0; i < tileKeys.length; i++) {\r\n      var tile = tileKeys[i];\r\n      var collisionFlag = this.player.tiles[tile];\r\n      var [x, y] = this.convertIndexToCoordinates(tile);\r\n      if (collisionFlag & 1) {\r\n        this.render.drawRect(x, y, 0.05, 1, \"#fff\");\r\n      }\r\n      if (collisionFlag & 2) {\r\n        this.render.drawRect(x + 0.95, y, 0.05, 1, \"#fff\");\r\n      }\r\n      if (collisionFlag & 4) {\r\n        this.render.drawRect(x, y, 1, 0.05, \"#fff\");\r\n      }\r\n      if (collisionFlag & 8) {\r\n        this.render.drawRect(x, y + 0.95, 1, 0.05, \"#fff\");\r\n      }\r\n    }\r\n\r\n    this.particleSystem.render();\r\n  }\r\n\r\n  updateGame(delta) {\r\n    this.fpsTick += delta;\r\n    if (this.fpsTick > 0.5) {\r\n      this.fpsTick = 0;\r\n\r\n      this.fps = Math.floor(1 / delta);\r\n    }\r\n\r\n    this.spawnTick += delta;\r\n    if (this.spawnTick > 2) {\r\n      this.spawnTick = 0;\r\n\r\n      this.spawnEntity();\r\n    }\r\n\r\n    this.controller.update(delta);\r\n\r\n    var deleteUUIDs = [];\r\n\r\n    for (var entityUUID in this.entities) {\r\n      var entity = this.entities[entityUUID];\r\n\r\n      entity.update(delta);\r\n\r\n      if (entity.delete) {\r\n        deleteUUIDs.push(entityUUID);\r\n      }\r\n    }\r\n\r\n    for (var entityUUID of deleteUUIDs) {\r\n      delete this.entities[entityUUID];\r\n    }\r\n\r\n    this.player.update(delta);\r\n    this.particleSystem.update(delta);\r\n    this.camera.update(delta);\r\n  }\r\n}\r\n","const SpriteSheets = {\r\n  player_idle: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/idle/1.png\",\r\n    max: 7,\r\n  },\r\n  player_run: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/run/1.png\",\r\n    max: 8,\r\n  },\r\n  player_jump: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/jump/1.png\",\r\n    max: 3,\r\n  },\r\n  player_land: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/land/1.png\",\r\n    max: 2,\r\n  },\r\n  player_slide: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/slide/1.png\",\r\n    max: 4,\r\n  },\r\n  player_roll: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/roll/1.png\",\r\n    max: 10,\r\n  },\r\n  player_combat_combo_01_attack_01: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/combat_combo_01_attack_01/1.png\",\r\n    max: 6,\r\n  },\r\n  player_combat_combo_01_attack_02: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/combat_combo_01_attack_02/1.png\",\r\n    max: 5,\r\n  },\r\n  player_combat_combo_01_attack_03: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/combat_combo_01_attack_03/1.png\",\r\n    max: 4,\r\n  },\r\n  player_combat_combo_01_attack_04: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/combat_combo_01_attack_04/1.png\",\r\n    max: 9,\r\n  },\r\n  player_combat_ground_slam: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/combat_ground_slam/1.png\",\r\n    max: 10,\r\n  },\r\n  player_look_up: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/look_up/1.png\",\r\n    max: 3,\r\n  },\r\n  player_knockback: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/knockback/1.png\",\r\n    max: 6,\r\n  },\r\n  player_ledge_climb: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/ledge_climb/1.png\",\r\n    max: 8,\r\n  },\r\n  player_ledge_hang: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/ledge_hang/1.png\",\r\n    max: 6,\r\n  },\r\n  player_wall_jump: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/wall_jump/1.png\",\r\n    max: 11,\r\n  },\r\n  player_wall_slide: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/wall_slide/1.png\",\r\n    max: 6,\r\n  },\r\n  player_crouch: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/crouch/1.png\",\r\n    max: 6,\r\n  },\r\n  player_crawl: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/crawl/1.png\",\r\n    max: 8,\r\n  },\r\n  player_front_flip: {\r\n    type: \"increment_file_name\",\r\n    imgPath: \"pixel_platformer_player/front_flip/1.png\",\r\n    max: 14,\r\n  },\r\n};\r\n\r\nexport default SpriteSheets;\r\n","import { useEffect, useRef, useState } from \"react\";\r\nimport Game from \"./Game\";\r\nimport SpriteSheets from \"./data/SpriteSheets\";\r\nimport SpriteSheetManager from \"./SpriteSheetManager\";\r\nimport SpriteSheet from \"./SpriteSheet\";\r\n\r\nfunction App() {\r\n  var canvasRef = useRef();\r\n\r\n  /**\r\n   * Show menu\r\n   */\r\n  var [menu, setMenu] = useState(false);\r\n  var gameRef = useRef();\r\n\r\n  useEffect(() => {\r\n    var ssm = new SpriteSheetManager();\r\n\r\n    Object.keys(SpriteSheets).forEach((spriteSheetName) => {\r\n      var data = SpriteSheets[spriteSheetName];\r\n      ssm.addSpriteSheet(spriteSheetName, data.imgPath, data);\r\n    });\r\n\r\n    /**\r\n     * @type {HTMLCanvasElement}\r\n     */\r\n    var canvas = canvasRef.current;\r\n    if (!canvas) {\r\n      return;\r\n    }\r\n\r\n    /**\r\n     * @type {CanvasRenderingContext2D}\r\n     */\r\n    var ctx = canvas.getContext(\"2d\");\r\n\r\n    var last = performance.now();\r\n\r\n    var game = new Game(canvas, ctx, ssm);\r\n    gameRef.current = game;\r\n\r\n    window.game = game;\r\n\r\n    var cb = () => {\r\n      canvas.width = window.innerWidth;\r\n      canvas.height = window.innerHeight;\r\n\r\n      canvas.style.width = window.innerWidth + \"px\";\r\n      canvas.style.height = window.innerHeight + \"px\";\r\n\r\n      game.camera.updateAspectRatio();\r\n    };\r\n    cb();\r\n    var active = true;\r\n    game.active = true;\r\n\r\n    function update() {\r\n      var now = performance.now();\r\n      var delta = (now - last) / 1000;\r\n      last = now;\r\n\r\n      if (delta > 0.25) {\r\n        delta = 0.25;\r\n      }\r\n\r\n      ctx.fillStyle = \"#000\";\r\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n\r\n      if (game.active) {\r\n        game.updateGame(delta);\r\n      }\r\n      game.renderGame(delta);\r\n\r\n      active && requestAnimationFrame(update);\r\n    }\r\n\r\n    ssm.onLoaded = () => {\r\n      Object.keys(ssm.spriteSheets).forEach((key) => {\r\n        if (key.includes(\"player_\")) {\r\n          ssm.spriteSheets[key].getEffects([\"flipHorizontally\"]);\r\n        }\r\n      });\r\n\r\n      update();\r\n\r\n      setTimeout(() => {\r\n        game.start();\r\n        // setMenu(true);\r\n      }, 100);\r\n    };\r\n\r\n    window.addEventListener(\"resize\", cb);\r\n\r\n    return () => {\r\n      cancelAnimationFrame(update);\r\n      window.removeEventListener(\"resize\", cb);\r\n\r\n      active = false;\r\n\r\n      game.end();\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div className={!menu ? \"hide-cursor\" : \"\"}>\r\n      <div className={\"main-menu\" + (menu ? \" main-menu-show\" : \"\")}>\r\n        <h1>Platformer</h1>\r\n        <p>by: MichaelXF</p>\r\n\r\n        <button\r\n          className='main-btn'\r\n          onClick={() => {\r\n            // Start game\r\n            setMenu(false);\r\n          }}\r\n        >\r\n          Play\r\n        </button>\r\n      </div>\r\n\r\n      <canvas ref={canvasRef} />\r\n\r\n      <div className='controls'>\r\n        <kbd>W</kbd>\r\n        <kbd>A</kbd>\r\n        <kbd>S</kbd>\r\n        <kbd>D</kbd>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}